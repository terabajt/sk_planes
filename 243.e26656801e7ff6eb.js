"use strict";(self.webpackChunksk_planes=self.webpackChunksk_planes||[]).push([[243],{6243:(z,F,l)=>{l.r(F),l.d(F,{FlightsModule:()=>$});var m=l(6895),T=l(4724),s=l(4006),h=l(284),w=l(8505),t=l(4650),v=l(4004),x=l(7471);let p=(()=>{class i{constructor(e){this.db=e,this.API_URL="/flights"}getFlights(){return this.db.list(this.API_URL).snapshotChanges().pipe((0,v.U)(e=>e.map(o=>this.assignKey(o))))}editFlight(e,o){return this.db.object(`${this.API_URL}/${e}`).update(o)}getFlight(e){return this.db.object(`${this.API_URL}/${e}`).snapshotChanges().pipe((0,v.U)(o=>this.assignKey(o)))}addFlight(e){return this.db.list(this.API_URL).push(e)}removeFlight(e){return this.db.object(`${this.API_URL}/${e}`).remove()}assignKey(e){return{...e.payload.val(),key:e.key}}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(x.KQ))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var C=l(7009),u=l(3336),g=l(4859);const A=i=>i.value.startsWith("SK")?null:{incorrectCode:!0};var f=l(9549),y=l(4144),U=l(6709),M=l(5113),N=l(3238);function k(i,n){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"Code is required!"),t.qZA())}function I(i,n){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"Minimum length is 4 characters."),t.qZA())}function q(i,n){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"Maximum length is 7 characters."),t.qZA())}function O(i,n){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"Code must start with SK prefix."),t.qZA())}function S(i,n){if(1&i&&(t.TgZ(0,"mat-option",26),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij(" ",e.label," ")}}function J(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"div",18)(1,"div",19)(2,"div",14)(3,"span"),t._uU(4),t.qZA(),t.TgZ(5,"mat-icon",20),t.NdJ("click",function(){const a=t.CHM(e).index,d=t.oxw();return t.KtG(d.removeCrewMember(a))}),t._uU(6,"delete_forever"),t.qZA()()(),t.TgZ(7,"div",21)(8,"div",22)(9,"mat-form-field"),t._UZ(10,"input",23),t.qZA()(),t.TgZ(11,"div",7)(12,"mat-form-field")(13,"mat-select",24),t.YNc(14,S,2,2,"mat-option",25),t.qZA()()()()()}if(2&i){const e=n.index,o=t.oxw();t.xp6(4),t.hij(" Crew Member - ",e+1," "),t.xp6(3),t.Q6J("formGroupName",e),t.xp6(7),t.Q6J("ngForOf",o.jobs)}}let _=(()=>{class i{constructor(e){this.formBuilder=e,this.editMode=!1,this.jobs=[{label:"Stewardess",value:"stewardess"},{label:"Senior Cabin Crew",value:"senior_cabin_crew"},{label:"Pilot",value:"pilot"},{label:"Co-Pilot",value:"co_pilot"},{label:"Mechanic",value:"mechanic"}]}ngOnInit(){this.buildForm()}setFlight(e){const{key:o,...r}=e;this.form.patchValue(r),r.crew.forEach(a=>this.addCrewMember(a))}addCrewMember(e){this.crew.push(this.buildCrewMember())}get crew(){return this.form.get("crew")}removeCrewMember(e){this.crew.removeAt(e)}buildCrewMember(e={}){return this.formBuilder.group({name:e.name||"",job:e.job||""})}buildForm(){this.form=this.formBuilder.group({origin:["",{validators:[s.kI.required]}],destination:["",{validators:[s.kI.required]}],departureTime:["",{validators:[s.kI.required]}],returnTime:["",{validators:[s.kI.required]}],code:["SK",{validators:[s.kI.required,s.kI.minLength(4),s.kI.maxLength(7),A]}],additionalInformation:"",withSKPlanesDiscount:!1,crew:this.formBuilder.array(this.editMode?[]:[this.buildCrewMember()])})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(s.qu))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-flight-form"]],inputs:{editMode:"editMode"},decls:40,vars:7,consts:[[3,"formGroup"],[1,"row"],[1,"col-sm-8"],["matInput","","placeholder","Code","formControlName","code"],["codeInput",""],[4,"ngIf"],["align","end"],[1,"col-sm-4"],["matInput","","placeholder","Origin","formControlName","origin"],["matInput","","placeholder","Destination","formControlName","destination"],["matInput","","placeholder","Departure  time","formControlName","departureTime"],["matInput","","placeholder","Return time","formControlName","returnTime"],[1,"wor"],["matInput","","placeholder","Additional Information","formControlName","additionalInformation"],[1,"col"],["formControlName","withSKPlanesDiscount"],["formArrayName","crew","class","crew-container shadow",4,"ngFor","ngForOf"],["mat-raised-button","","color","primary",3,"click"],["formArrayName","crew",1,"crew-container","shadow"],[1,"row","crew-header"],[1,"float-right",3,"click"],[1,"row",3,"formGroupName"],[1,"col-sm-5"],["matInput","","formControlName","name","placeholder","Name"],["formControlName","job","placeholder","Job"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,o){if(1&e&&(t.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"mat-form-field"),t._UZ(4,"input",3,4),t.YNc(6,k,2,0,"mat-error",5),t.YNc(7,I,2,0,"mat-error",5),t.YNc(8,q,2,0,"mat-error",5),t.YNc(9,O,2,0,"mat-error",5),t.TgZ(10,"mat-hint",6),t._uU(11),t.qZA()()()(),t.TgZ(12,"div",1)(13,"div",7)(14,"mat-form-field"),t._UZ(15,"input",8),t.qZA()(),t.TgZ(16,"div",7)(17,"mat-form-field"),t._UZ(18,"input",9),t.qZA()()(),t.TgZ(19,"div",1)(20,"div",7)(21,"mat-form-field"),t._UZ(22,"input",10),t.qZA()(),t.TgZ(23,"div",7)(24,"mat-form-field"),t._UZ(25,"input",11),t.qZA()()(),t.TgZ(26,"div",12)(27,"div",2)(28,"mat-form-field"),t._UZ(29,"textarea",13),t.qZA()()(),t.TgZ(30,"div",1)(31,"div",14)(32,"mat-checkbox",15),t._uU(33,"With SK Discount"),t.qZA()()(),t.YNc(34,J,15,3,"div",16),t.TgZ(35,"div",1)(36,"div",14),t._uU(37," <"),t.TgZ(38,"button",17),t.NdJ("click",function(){return o.addCrewMember()}),t._uU(39,"Add crew member"),t.qZA()()()()),2&e){const r=t.MAs(5);let a,d,Z,b;t.Q6J("formGroup",o.form),t.xp6(6),t.Q6J("ngIf",null==(a=o.form.get("code"))?null:a.hasError("required")),t.xp6(1),t.Q6J("ngIf",null==(d=o.form.get("code"))?null:d.hasError("minlength")),t.xp6(1),t.Q6J("ngIf",null==(Z=o.form.get("code"))?null:Z.hasError("maxlength")),t.xp6(1),t.Q6J("ngIf",null==(b=o.form.get("code"))?null:b.hasError("incorrectCode")),t.xp6(2),t.hij("",r.value.length," / 7 "),t.xp6(23),t.Q6J("ngForOf",o.crew.controls)}},dependencies:[m.sg,m.O5,u.Hw,f.TO,f.KE,f.bx,y.Nt,g.lW,U.oG,M.gD,N.ey,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,s.x0,s.CE],styles:[".crew-container[_ngcontent-%COMP%]{margin-top:15px;padding:15px;background:white}.crew-header[_ngcontent-%COMP%]{margin-bottom:20px;font-weight:700}"]}),i})();const E=["flightForm"];let Y=(()=>{class i{constructor(e,o,r,a){this.route=e,this.router=o,this.flightsService=r,this.toast=a}ngAfterViewInit(){this.loadFlight()}removeFlight(){this.flightsService.removeFlight(this.flight.key).then(this.onRemoveSuccess.bind(this),this.onFailure.bind(this))}editFlight(){this.flightsService.editFlight(this.flight.key,this.flightForm.form.value).then(this.onEditSuccess.bind(this),this.onFailure.bind(this))}onEditSuccess(){this.router.navigate(["/dashboard"]),this.toast.open("Flight has been successfully edited","",{panelClass:"toast-success"})}onRemoveSuccess(){this.router.navigate(["/dashboard"]),this.toast.open("Flight has been successfully removed","",{panelClass:"toast-success"})}onFailure(e){this.toast.open(e,"",{panelClass:"toast-error"})}loadFlight(){this.flightsService.getFlight(this.route.snapshot.params.key).pipe((0,w.b)(o=>this.flightForm.setFlight(o))).subscribe(o=>this.flight=o)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(h.gz),t.Y36(h.F0),t.Y36(p),t.Y36(C.ux))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-edit-flights"]],viewQuery:function(e,o){if(1&e&&t.Gf(E,5),2&e){let r;t.iGM(r=t.CRH())&&(o.flightForm=r.first)}},decls:18,vars:2,consts:[[1,"row"],[1,"col-9"],[1,"col-3"],[1,"remove-btn",3,"click"],[3,"editMode"],["flightForm",""],[1,"col","text-end"],["mat-raised-button",""],["mat-raised-button","","color","primary",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h3"),t._uU(3,"EditFlight "),t.TgZ(4,"strong"),t._uU(5),t.qZA(),t._uU(6," details"),t.qZA()(),t.TgZ(7,"div",2)(8,"mat-icon",3),t.NdJ("click",function(){return o.removeFlight()}),t._uU(9,"delete_forever"),t.qZA()()(),t._UZ(10,"app-flight-form",4,5),t.TgZ(12,"div",0)(13,"div",6)(14,"button",7),t._uU(15,"RESET"),t.qZA(),t.TgZ(16,"button",8),t.NdJ("click",function(){return o.editFlight()}),t._uU(17,"SAVE"),t.qZA()()()),2&e&&(t.xp6(5),t.Oqu(o.flight.code),t.xp6(5),t.Q6J("editMode",!0))},dependencies:[u.Hw,g.lW,_],styles:[".remove-btn[_ngcontent-%COMP%]{color:red;cursor:pointer;font-size:42px;padding-top:15px;z-index:3000;width:100%;height:100%}"]}),i})();var c=l(5412);function P(i,n){if(1&i&&(t.TgZ(0,"li"),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.xp6(1),t.hij(" ",e.name," ")}}let D=(()=>{class i{constructor(e,o,r){this.router=e,this.dialogRef=o,this.data=r,this.flight=r}close(){this.dialogRef.close()}goToEditFlight(){this.close(),this.router.navigate(["/dashboard/flights/",this.flight.key])}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(h.F0),t.Y36(c.so),t.Y36(c.WI))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-details"]],decls:14,vars:2,consts:[[1,"row"],[1,"col"],[1,"float-end",3,"click"],[1,"label"],[4,"ngFor","ngForOf"],["mat-raised-button","","color","primary",1,"float-end",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h3"),t._uU(3,"FLIGHT DETAILS "),t.TgZ(4,"mat-icon",2),t.NdJ("click",function(){return o.close()}),t._uU(5,"close"),t.qZA()(),t.TgZ(6,"p",3),t._uU(7),t.qZA(),t.TgZ(8,"p",3),t._uU(9,"Crew:"),t.qZA(),t.TgZ(10,"ul"),t.YNc(11,P,2,1,"li",4),t.qZA(),t.TgZ(12,"button",5),t.NdJ("click",function(){return o.goToEditFlight()}),t._uU(13," EDIT FLIGHT"),t.qZA()()()),2&e&&(t.xp6(7),t.hij("Code: ",o.flight.code,""),t.xp6(4),t.Q6J("ngForOf",o.flight.crew))},dependencies:[m.sg,u.Hw,g.lW]}),i})();const Q=["flightForm"];let R=(()=>{class i{constructor(e,o,r){this.dialogRef=e,this.flightsService=o,this.toast=r}createFlight(){console.log(this.flightForm),this.flightsService.addFlight(this.flightForm.form.value).then(this.onCreatingSuccess.bind(this),this.onCreatingFailure.bind(this))}onCreatingSuccess(){this.dialogRef.close(),this.toast.open("Flight has been successfully created!","",{panelClass:"toast-success"})}onCreatingFailure(e){this.toast.open(e.message,"",{panelClass:"toast-error"})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(c.so),t.Y36(p),t.Y36(C.ux))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-new-flight"]],viewQuery:function(e,o){if(1&e&&t.Gf(Q,5),2&e){let r;t.iGM(r=t.CRH())&&(o.flightForm=r.first)}},decls:12,vars:1,consts:[["mat-dialog-title",""],["flightForm",""],[1,"row"],[1,"col"],["mat-raised-button","","mat-dialog-close",""],["mat-raised-button","","color","primary",3,"disabled","click"]],template:function(e,o){if(1&e&&(t.TgZ(0,"h2",0),t._uU(1,"New Flight Creator"),t.qZA(),t.TgZ(2,"mat-dialog-content"),t._UZ(3,"app-flight-form",null,1),t.qZA(),t.TgZ(5,"mat-dialog-actions")(6,"div",2)(7,"div",3)(8,"button",4),t._uU(9," Cancel"),t.qZA(),t.TgZ(10,"button",5),t.NdJ("click",function(){return o.createFlight()}),t._uU(11," Create"),t.qZA()()()()),2&e){const r=t.MAs(4);t.xp6(10),t.Q6J("disabled",r.form.invalid)}},dependencies:[c.ZT,c.uh,c.xY,c.H8,g.lW,_]}),i})(),j=(()=>{class i{constructor(e){this.cd=e}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(t.sBO))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-flight-card"]],inputs:{flight:"flight"},decls:15,vars:4,consts:[[1,"card-container"],[1,"shadow","card-content"],[1,"row"],[1,"col"],[1,"origin"],[1,"destination"],[1,"time"],[1,"icon-container","shadow"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"p",4),t._uU(5),t.qZA(),t.TgZ(6,"p",5),t._uU(7),t.qZA()()(),t.TgZ(8,"div",2)(9,"div",3)(10,"p",6),t._uU(11),t.qZA()()()(),t.TgZ(12,"div",7)(13,"mat-icon"),t._uU(14,"airplanemode_active"),t.qZA()()()),2&e&&(t.xp6(5),t.Oqu(o.flight.origin),t.xp6(2),t.Oqu(o.flight.destination),t.xp6(4),t.AsE(" ",o.flight.departureTime," - ",o.flight.returnTime,""))},dependencies:[u.Hw],styles:["[_nghost-%COMP%]{cursor:pointer}.card-container[_ngcontent-%COMP%]{padding:10px;position:relative}.card-content[_ngcontent-%COMP%]{padding:30px 20px;background:white}.icon-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;left:50%;top:-10px;height:50px;width:50px;background:white;border-radius:50%;z-index:10;border:1px solid grey;transform:translate(-50%)}.icon-container[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#00008b}.time[_ngcontent-%COMP%]{text-align:center;font-size:13px;color:gray}.destination[_ngcontent-%COMP%], .origin[_ngcontent-%COMP%]{font-size:26px;font-weight:700;color:#ff1493}"],changeDetection:0}),i})();function G(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"div",3),t.NdJ("click",function(){const a=t.CHM(e).$implicit,d=t.oxw();return t.KtG(d.showDetails(a))}),t._UZ(1,"app-flight-card",4),t.qZA()}if(2&i){const e=n.$implicit;t.xp6(1),t.Q6J("flight",e)}}const L=[{path:"flights",component:(()=>{class i{constructor(e,o){this.dialog=e,this.flightService=o,this.flights$=this.flightService.getFlights()}openNewFlightModal(){this.dialog.open(R)}showDetails(e){this.dialog.open(D,{data:e})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(c.uw),t.Y36(p))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-flights"]],decls:5,vars:3,consts:[[1,"row","flights-container"],["class","col-sm-4",3,"click",4,"ngFor","ngForOf"],["mat-fab","","color","accent","id","new-flight-btn",3,"click"],[1,"col-sm-4",3,"click"],[3,"flight"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0),t.YNc(1,G,2,1,"div",1),t.ALo(2,"async"),t.qZA(),t.TgZ(3,"button",2),t.NdJ("click",function(){return o.openNewFlightModal()}),t._uU(4,"+"),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngForOf",t.lcZ(2,1,o.flights$)))},dependencies:[m.sg,g.lW,j,m.Ov],styles:[".flights-container[_ngcontent-%COMP%]{padding-top:30px}#new-flight-btn[_ngcontent-%COMP%]{position:fixed;bottom:50px;right:50px;font-size:30px}"]}),i})()},{path:":key",component:Y}];let K=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[h.Bz.forChild(L),h.Bz]}),i})(),$=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[m.ez,T.q,s.u5,s.UX,K]}),i})()}}]);